Created a simple tcp server in powershell with the help of claude.

This takes logs from the tecom challenger and writes them to a file as well as displays them at a powershell prompt. The reason for doing this was to generate a file of ACSII string I could alter and save them to a posgresSQL database which could be queried and graphed.

Next I will ask claude to spin me up a posgresSQL database in a container to send these strings to.

Installed Docker desktop on this machine for testing. Its too awkward to use my docker server and give claude access to it.

# Simple TCP Server that writes received data to a file
# Usage: .\tcp-server.ps1

$port = 9997
$logFile = "tcp-data.txt"

# Create TCP listener
$listener = [System.Net.Sockets.TcpListener]::new([System.Net.IPAddress]::Any, $port)
$listener.Start()

Write-Host "TCP Server listening on port $port..."
Write-Host "Logging to: $logFile"
Write-Host "Press Ctrl+C to stop"
Write-Host ""

try {
    while ($true) {
        Write-Host "Waiting for connection..."

        # Accept incoming connection
        $client = $listener.AcceptTcpClient()
        $clientEndpoint = $client.Client.RemoteEndPoint
        Write-Host "Connection from: $clientEndpoint"

        try {
            $stream = $client.GetStream()
            $buffer = New-Object byte[] 1024

            # Read data from client
            while ($client.Connected) {
                # Check if data is available
                if ($stream.DataAvailable) {
                    $bytesRead = $stream.Read($buffer, 0, $buffer.Length)

                    if ($bytesRead -gt 0) {
                        # Convert bytes to ASCII string
                        $data = [System.Text.Encoding]::ASCII.GetString($buffer, 0, $bytesRead)

                        # Split by newlines and process each line
                        $lines = $data -split "`r`n|`n|`r"

                        foreach ($line in $lines) {
                            if ($line.Trim()) {
                                $timestamp = Get-Date -Format "yyyy-MM-dd HH:mm:ss"
                                $logEntry = "[$timestamp] $line"

                                # Write to console
                                Write-Host $logEntry

                                # Append to file
                                Add-Content -Path $logFile -Value $logEntry
                            }
                        }
                    }
                }
                else {
                    # No data available, small delay to avoid tight loop
                    Start-Sleep -Milliseconds 50
                }
            }
        }
        catch {
            Write-Host "Error during communication: $($_.Exception.Message)"
        }
        finally {
            # Cleanup client connection
            if ($stream) { $stream.Close() }
            if ($client) { $client.Close() }
            Write-Host "Client disconnected"
            Write-Host ""
        }
    }
}
catch {
    Write-Host "Server error: $($_.Exception.Message)"
}
finally {
    # Stop listener on exit
    $listener.Stop()
    Write-Host "Server stopped"
}
